{"version":3,"file":"components.js","sources":["../../../../packages/ui/src/useApp.ts","../../../../packages/ui/src/page/src/index.vue","../../../../packages/ui/src/useCommonMethod.ts","../../../../packages/ui/src/Component.vue","../../../../packages/ui/src/container/src/Container.vue","../../../../packages/ui/src/button/src/index.vue","../../../../packages/ui/src/text/src/index.vue","../../src/comp-entry.ts"],"sourcesContent":["/*\n * Tencent is pleased to support the open source community by making TMagicEditor available.\n *\n * Copyright (C) 2021 THL A29 Limited, a Tencent company.  All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getCurrentInstance, inject, onMounted, onUnmounted } from 'vue';\n\nimport Core from '@tmagic/core';\n\nexport default (props: any) => {\n  const app: Core | undefined = inject('app');\n  const node = app?.page?.getNode(props.config.id);\n\n  const vm = getCurrentInstance()?.proxy;\n\n  node?.emit('created', vm);\n\n  onMounted(() => {\n    node?.emit('mounted', vm);\n  });\n\n  onUnmounted(() => {\n    node?.emit('destroy', vm);\n  });\n\n  return app;\n};\n","<template>\n  <magic-ui-container class=\"magic-ui-page\" :config=\"config\">\n    <slot></slot>\n  </magic-ui-container>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\n\nimport { MPage } from '@tmagic/schema';\n\nimport useApp from '../../useApp';\n\nexport default defineComponent({\n  name: 'magic-ui-page',\n  props: {\n    config: {\n      type: Object as PropType<MPage>,\n      defautl: () => ({}),\n    },\n  },\n\n  setup(props) {\n    if (props.config) {\n      useApp(props);\n    }\n  },\n});\n</script>\n","/*\n * Tencent is pleased to support the open source community by making TMagicEditor available.\n *\n * Copyright (C) 2021 THL A29 Limited, a Tencent company.  All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default (props: any) => ({\n  show: () => {\n    props.config.style.display = 'initial';\n  },\n  hide: () => {\n    props.config.style.display = 'none';\n  },\n});\n","<template>\n  <component\n    v-if=\"display()\"\n    :is=\"tagName\"\n    :id=\"config.id\"\n    :class=\"`magic-ui-component${config.className ? ` ${config.className}` : ''}`\"\n    :style=\"style\"\n    :config=\"config\"\n  ></component>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, getCurrentInstance, provide } from 'vue';\n\nimport { toLine } from '@tmagic/utils';\n\nimport useApp from './useApp';\nimport useCommonMethod from './useCommonMethod';\n\nexport default defineComponent({\n  name: 'magic-ui-component',\n\n  props: {\n    config: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n\n  setup(props) {\n    const vm = getCurrentInstance()?.proxy;\n    const app = useApp(props);\n\n    provide('hoc', vm);\n\n    return {\n      tagName: computed(() => `magic-ui-${toLine(props.config.type)}`),\n      style: computed(() => app?.transformStyle(props.config.style)),\n\n      display: () => {\n        const displayCfg = props.config?.display;\n\n        if (typeof displayCfg === 'function') {\n          return displayCfg(app);\n        }\n        return displayCfg !== false;\n      },\n      ...useCommonMethod(props),\n    };\n  },\n});\n</script>\n","<template>\n  <div\n    v-if=\"display()\"\n    :id=\"config.id\"\n    :class=\"`magic-ui-container${config.className ? ` ${config.className}` : ''}`\"\n    :style=\"style\"\n  >\n    <slot></slot>\n    <magic-ui-component v-for=\"item in config.items\" :key=\"item.id\" :config=\"item\"></magic-ui-component>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, PropType } from 'vue';\n\nimport { MContainer } from '@tmagic/schema';\n\nimport Component from '../../Component.vue';\nimport useApp from '../../useApp';\nimport useCommonMethod from '../../useCommonMethod';\n\nexport default defineComponent({\n  name: 'magic-ui-container',\n\n  components: {\n    'magic-ui-component': Component,\n  },\n\n  props: {\n    config: {\n      type: Object as PropType<MContainer>,\n      default: () => ({}),\n    },\n  },\n\n  setup(props) {\n    const app = useApp(props);\n\n    return {\n      style: computed(() => app?.transformStyle(props.config.style || {})),\n\n      display: () => {\n        const displayCfg = props.config?.display;\n\n        if (typeof displayCfg === 'function') {\n          return displayCfg(app);\n        }\n        return displayCfg !== false;\n      },\n      ...useCommonMethod(props),\n    };\n  },\n});\n</script>\n","<template>\n  <button class=\"magic-ui-button\" @click=\"clickHandler\">\n    <slot>\n      <magic-ui-text :config=\"textConfig\"></magic-ui-text>\n    </slot>\n  </button>\n</template>\n<script lang=\"ts\">\nimport { computed, defineComponent, getCurrentInstance, PropType, reactive } from 'vue';\n\nimport { MButton, MButtonInstance, MText } from '../../../src/types';\n\nexport default defineComponent({\n  name: 'magic-ui-button',\n  props: {\n    config: {\n      type: Object as PropType<MButton>,\n      default: () => ({}),\n    },\n\n    model: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  setup(props) {\n    const vm: MButtonInstance = getCurrentInstance()?.proxy as MButtonInstance;\n    const actions = reactive<Function[]>([]);\n    const actualActions = computed(() => [\n      typeof props.config.preAction === 'function' ? props.config.preAction : () => true,\n      ...actions,\n      typeof props.config.postAction === 'function' ? props.config.postAction : () => true,\n    ]);\n    function pushAction(action: Function): void {\n      actions.push(action);\n    }\n    async function clickHandler(): Promise<void> {\n      for (const fn of actualActions.value) {\n        if (typeof fn === 'function') {\n          const ret = await fn(vm, { model: props.model });\n          if (ret === false) {\n            break;\n          }\n        }\n      }\n    }\n\n    const textConfig = computed<MText>(() => ({\n      type: 'text',\n      text: props.config?.text || '',\n      disabledText: props.config?.disabledText || '',\n      html: props.config?.html || '',\n    }));\n\n    return {\n      pushAction,\n      clickHandler,\n      textConfig,\n    };\n  },\n});\n</script>\n","<script lang=\"ts\">\nimport { computed, defineComponent, getCurrentInstance, h, inject, PropType } from 'vue';\n\nimport { MComponentInstance, MText, MTextInstance } from '../../../src/types';\n\nexport default defineComponent({\n  name: 'magic-ui-text',\n  props: {\n    config: {\n      type: Object as PropType<MText>,\n      default: () => ({}),\n    },\n\n    model: {\n      type: Object,\n      default: () => ({}),\n    },\n\n    vars: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  setup(props) {\n    const vm: MTextInstance = getCurrentInstance()?.proxy as MTextInstance;\n    const hoc: MComponentInstance = inject('hoc');\n    const displayText = computed(() => {\n      let text = props.config?.text || '';\n      const { vars } = props;\n      if (hoc?.disabled && props.config?.disabledText) {\n        text = props.config.disabledText;\n      }\n      if (typeof text === 'function') {\n        return text.bind(vm)(vm, { model: props.model });\n      }\n      if (Object.prototype.toString.call(vars) === '[object Object]') {\n        let tmp: string = text;\n        Object.entries(vars).forEach(([key, value]) => {\n          tmp = tmp.replace(new RegExp(`{{${key}}}`, 'g'), value);\n        });\n        return tmp;\n      }\n      return text || '';\n    });\n\n    return {\n      displayText,\n    };\n  },\n\n  render() {\n    const className = this.config?.multiple ? 'magic-ui-text' : 'magic-ui-text magic-ui-text--single-line';\n    if (typeof this.$slots?.default === 'function') {\n      return h('span', { class: className }, [this.$slots?.default?.() || '']);\n    }\n    return h('span', {\n      class: className,\n      ...(this.displayText ? { innerHTML: this.displayText } : {}),\n    });\n  },\n});\n</script>\n","import page from '/parisma/github/tmagic-editor/packages/ui/src/page/src/index.vue';\nimport container from '/parisma/github/tmagic-editor/packages/ui/src/container/src/Container.vue';\nimport button from '/parisma/github/tmagic-editor/packages/ui/src/button/src/index.vue';\nimport text from '/parisma/github/tmagic-editor/packages/ui/src/text/src/index.vue';\n\nconst components: Record<string, any> = {\n  'page': page,\n  'container': container,\n  'button': button,\n  'text': text,\n};\n\nconst plugins = {};\n\nconst entry = {\n  components,\n  plugins,\n};\n\nwindow.magicPresetComponents = entry;\nexport default entry;"],"names":["_sfc_main","text"],"mappings":"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"}