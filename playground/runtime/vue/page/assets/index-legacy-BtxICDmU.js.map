{"version":3,"file":"index-legacy-BtxICDmU.js","sources":["../../../../../node_modules/.pnpm/@tmagic+vue-overlay@1.0.0_@tmagic+core@1.7.6_typescript@5.9.3__@tmagic+vue-runtime-help_069c58c7a443a5ba9250b71af96e82e6/node_modules/@tmagic/vue-overlay/src/index.vue"],"sourcesContent":["<template>\n  <component v-if=\"visible\" :is=\"containerComponent\" :config=\"{ items: config.items, [IS_DSL_NODE_KEY]: false }\">\n    <slot></slot>\n  </component>\n</template>\n\n<script lang=\"ts\" setup>\nimport { inject, onBeforeUnmount, ref } from 'vue';\n\nimport type TMagicApp from '@tmagic/core';\nimport { type Id, IS_DSL_NODE_KEY, type MContainer, type MNode, type MPage } from '@tmagic/core';\nimport { type ComponentProps, registerNodeHooks, useComponent, useNode } from '@tmagic/vue-runtime-help';\n\ninterface OverlaySchema extends Omit<MContainer, 'id'> {\n  id?: Id;\n  type?: 'overlay';\n}\n\ndefineOptions({\n  name: 'tmagic-overlay',\n});\n\nconst props = defineProps<ComponentProps<OverlaySchema>>();\n\nconst visible = ref(false);\n\nconst app = inject<TMagicApp>('app');\nconst containerComponent = useComponent({ componentType: 'container', app });\n\nconst openOverlay = () => {\n  visible.value = true;\n  app?.emit('overlay:open', node);\n};\n\nconst closeOverlay = () => {\n  visible.value = false;\n  app?.emit('overlay:close', node);\n};\n\nconst editorSelectHandler = (\n  _info: {\n    node: MNode;\n    page: MPage;\n    parent: MContainer;\n  },\n  path: MNode[],\n) => {\n  if (path.find((node: MNode) => node.id === props.config.id)) {\n    openOverlay();\n  } else {\n    closeOverlay();\n  }\n};\n\napp?.page?.on('editor:select', editorSelectHandler);\n\napp?.on('page-change', () => {\n  app?.page?.on('editor:select', editorSelectHandler);\n});\n\nonBeforeUnmount(() => {\n  app?.page?.off('editor:select', editorSelectHandler);\n});\n\nconst node = useNode(props, app);\nregisterNodeHooks(node, {\n  openOverlay,\n  closeOverlay,\n});\n\ndefineExpose({\n  openOverlay,\n  closeOverlay,\n});\n</script>\n"],"names":["props","__props","visible","ref","app","inject","containerComponent","useComponent","componentType","openOverlay","value","emit","node","closeOverlay","editorSelectHandler","_info","path","find","id","config","page","on","onBeforeUnmount","off","useNode","registerNodeHooks","__expose","_openBlock","_createBlock","_resolveDynamicComponent","_unref","items","IS_DSL_NODE_KEY","_renderSlot","_ctx","$slots"],"mappings":"meAsBA,MAAMA,EAAQC,EAERC,EAAUC,GAAI,GAEdC,EAAMC,EAAkB,OACxBC,EAAqBC,EAAa,CAAEC,cAAe,YAAaJ,QAEhEK,EAAcA,KAClBP,EAAQQ,OAAQ,EAChBN,GAAKO,KAAK,eAAgBC,IAGtBC,EAAeA,KACnBX,EAAQQ,OAAQ,EAChBN,GAAKO,KAAK,gBAAiBC,IAGvBE,EAAsBA,CAC1BC,EAKAC,KAEIA,EAAKC,KAAML,GAAgBA,EAAKM,KAAOlB,EAAMmB,OAAOD,IACtDT,IAEAI,KAIJT,GAAKgB,MAAMC,GAAG,gBAAiBP,GAE/BV,GAAKiB,GAAG,cAAe,KACrBjB,GAAKgB,MAAMC,GAAG,gBAAiBP,KAGjCQ,EAAgB,KACdlB,GAAKgB,MAAMG,IAAI,gBAAiBT,KAGlC,MAAMF,EAAOY,EAAQxB,EAAOI,UAC5BqB,EAAkBb,EAAM,CACtBH,cACAI,iBAGFa,EAAa,CACXjB,cACAI,wBAvEiBX,EAAAQ,OAAjBiB,IAAAC,EAEYC,EAFmBC,EAAAxB,IAAkB,OAAGa,OAAM,CAAAY,MAAW9B,EAAAkB,OAAOY,OAAQD,EAAAE,KAAe,eACjG,IAAa,CAAbC,EAAaC,EAAAC,OAAA","x_google_ignoreList":[0]}