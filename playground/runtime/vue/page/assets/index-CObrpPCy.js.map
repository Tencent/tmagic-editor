{"version":3,"file":"index-CObrpPCy.js","sources":["../../../../../node_modules/.pnpm/@tmagic+vue-overlay@1.0.0_@tmagic+core@1.7.6_typescript@5.9.3__@tmagic+vue-runtime-help_069c58c7a443a5ba9250b71af96e82e6/node_modules/@tmagic/vue-overlay/src/index.vue"],"sourcesContent":["<template>\n  <component v-if=\"visible\" :is=\"containerComponent\" :config=\"{ items: config.items, [IS_DSL_NODE_KEY]: false }\">\n    <slot></slot>\n  </component>\n</template>\n\n<script lang=\"ts\" setup>\nimport { inject, onBeforeUnmount, ref } from 'vue';\n\nimport type TMagicApp from '@tmagic/core';\nimport { type Id, IS_DSL_NODE_KEY, type MContainer, type MNode, type MPage } from '@tmagic/core';\nimport { type ComponentProps, registerNodeHooks, useComponent, useNode } from '@tmagic/vue-runtime-help';\n\ninterface OverlaySchema extends Omit<MContainer, 'id'> {\n  id?: Id;\n  type?: 'overlay';\n}\n\ndefineOptions({\n  name: 'tmagic-overlay',\n});\n\nconst props = defineProps<ComponentProps<OverlaySchema>>();\n\nconst visible = ref(false);\n\nconst app = inject<TMagicApp>('app');\nconst containerComponent = useComponent({ componentType: 'container', app });\n\nconst openOverlay = () => {\n  visible.value = true;\n  app?.emit('overlay:open', node);\n};\n\nconst closeOverlay = () => {\n  visible.value = false;\n  app?.emit('overlay:close', node);\n};\n\nconst editorSelectHandler = (\n  _info: {\n    node: MNode;\n    page: MPage;\n    parent: MContainer;\n  },\n  path: MNode[],\n) => {\n  if (path.find((node: MNode) => node.id === props.config.id)) {\n    openOverlay();\n  } else {\n    closeOverlay();\n  }\n};\n\napp?.page?.on('editor:select', editorSelectHandler);\n\napp?.on('page-change', () => {\n  app?.page?.on('editor:select', editorSelectHandler);\n});\n\nonBeforeUnmount(() => {\n  app?.page?.off('editor:select', editorSelectHandler);\n});\n\nconst node = useNode(props, app);\nregisterNodeHooks(node, {\n  openOverlay,\n  closeOverlay,\n});\n\ndefineExpose({\n  openOverlay,\n  closeOverlay,\n});\n</script>\n"],"names":["props","__props","visible","ref","app","inject","containerComponent","useComponent","openOverlay","node","closeOverlay","editorSelectHandler","_info","path","_a","onBeforeUnmount","useNode","registerNodeHooks","__expose","_openBlock","_createBlock","_resolveDynamicComponent","_unref","IS_DSL_NODE_KEY","_renderSlot","_ctx"],"mappings":"0XAsBA,MAAMA,EAAQC,EAERC,EAAUC,EAAI,EAAK,EAEnBC,EAAMC,EAAkB,KAAK,EAC7BC,EAAqBC,EAAa,CAAE,cAAe,YAAa,IAAAH,EAAK,EAErEI,EAAc,IAAM,CACxBN,EAAQ,MAAQ,GAChBE,GAAA,MAAAA,EAAK,KAAK,eAAgBK,EAAI,EAG1BC,EAAe,IAAM,CACzBR,EAAQ,MAAQ,GAChBE,GAAA,MAAAA,EAAK,KAAK,gBAAiBK,EAAI,EAG3BE,EAAsB,CAC1BC,EAKAC,IACG,CACCA,EAAK,KAAMJ,GAAgBA,EAAK,KAAOT,EAAM,OAAO,EAAE,EACxDQ,EAAA,EAEAE,EAAA,CACF,GAGFI,EAAAV,GAAA,YAAAA,EAAK,OAAL,MAAAU,EAAW,GAAG,gBAAiBH,GAE/BP,GAAA,MAAAA,EAAK,GAAG,cAAe,IAAM,QAC3BU,EAAAV,GAAA,YAAAA,EAAK,OAAL,MAAAU,EAAW,GAAG,gBAAiBH,EAAmB,GAGpDI,EAAgB,IAAM,QACpBD,EAAAV,GAAA,YAAAA,EAAK,OAAL,MAAAU,EAAW,IAAI,gBAAiBH,EAAmB,CACpD,EAED,MAAMF,EAAOO,EAAQhB,EAAOI,CAAG,EAC/B,OAAAa,EAAkBR,EAAM,CACtB,YAAAD,EACA,aAAAE,CAAA,CACD,EAEDQ,EAAa,CACX,YAAAV,EACA,aAAAE,CAAA,CACD,SAxEkBR,EAAA,OAAjBiB,EAAA,EAAAC,EAEYC,EAFmBC,EAAAhB,CAAA,CAAkB,EAAA,OAAG,OAAM,CAAA,MAAWL,EAAA,OAAO,OAAQqB,EAAAC,CAAA,CAAe,EAAA,EAAA,CAAA,aACjG,IAAa,CAAbC,EAAaC,EAAA,OAAA,SAAA,CAAA","x_google_ignoreList":[0]}