import{d as u,i as w,u as y,w as f,I as d,v as h,f as E,g,n as _,j as M,o as T}from"./index-D9hNCYDJ.js";import{a as m,_ as b}from"./plugin-vueexport-helper-xb2XXZRC.js";import{u as j}from"./use-component-status-BkOadN8h.js";const F=(()=>{const e=new Map;return(t,i,s=globalThis.document)=>{let o=e.get(s);if(o||(o=new Map,e.set(s,o)),o.get(t))return o.get(t);const r=new Promise((c,a)=>{const n=s.createElement("script");n.type="text/javascript",i&&(n.crossOrigin=i),n.src=t,s.body.appendChild(n),n.onload=()=>{c()},n.onerror=()=>{a(new Error("加载失败"))},setTimeout(()=>{a(new Error("timeout"))},60*1e3)}).catch(c=>{throw o.delete(t),c});return o.set(t,r),o.get(t)}})(),p=(()=>{const e=new Map;return(t,i=globalThis.document)=>{let s=e.get(i);if(s||(s=new Map,e.set(i,s)),s.get(t))return s.get(t);const o=new Promise((r,c)=>{const a=i.createElement("link");a.rel="stylesheet",a.href=t,i.head.appendChild(a),a.onload=()=>{r()},a.onerror=()=>{c(new Error("加载失败"))},setTimeout(()=>{c(new Error("timeout"))},60*1e3)}).catch(r=>{throw s.delete(t),r});return s.set(t,o),s.get(t)}})(),S=e=>{if(e.cssFile&&p(e.cssFile),Array.isArray(e.cssFiles)&&e.cssFiles.map(t=>p(t.url)),e.css){const t=window.document.createElement("style");t.innerHTML=e.css,window.document.head.appendChild(t)}},D=e=>{Array.isArray(e.jsFiles)&&e.jsFiles.map(t=>F(t.url))},L=u({name:"tmagic-page",props:{config:{type:Object,required:!0},model:{type:Object,default:()=>({})}},setup(e){const t=w("app");(t==null?void 0:t.jsEngine)==="browser"&&(S(e.config),D(e.config));const i=y({componentType:"container",app:t}),{style:s,className:o}=j(e),r=()=>{window.location.reload()};return f(()=>e.config,async(c,a)=>{const n=m({config:{...c,[d]:!0}},t);if(c.id!==(a==null?void 0:a.id)&&(n==null||n.setInstance({config:e.config,refresh:r}),n==null||n.emit("created")),await h(),c.id!==(a==null?void 0:a.id)){n==null||n.emit("mounted");const l=m({config:{...a,[d]:!0}},t);l==null||l.emit("destroy")}},{immediate:!0}),{style:s,className:o,containerComponent:i,IS_DSL_NODE_KEY:d}}});function k(e,t,i,s,o,r){return T(),E(M(e.containerComponent),{class:_(e.className),style:g(e.style),"data-tmagic-id":e.config.id,config:{...e.config,[e.IS_DSL_NODE_KEY]:!1}},null,8,["class","style","data-tmagic-id","config"])}const O=b(L,[["render",k]]);export{O as default};
//# sourceMappingURL=index-5d41vb3N.js.map
