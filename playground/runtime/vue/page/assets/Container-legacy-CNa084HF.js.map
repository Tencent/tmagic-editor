{"version":3,"file":"Container-legacy-CNa084HF.js","sources":["../../../../../node_modules/.pnpm/@tmagic+vue-container@2.0.0_@tmagic+core@1.7.6_typescript@5.9.3__@tmagic+vue-runtime-he_98f9c80ebf1387f841ccebd85af10b55/node_modules/@tmagic/vue-container/src/Component.ts","../../../../../node_modules/.pnpm/@tmagic+vue-container@2.0.0_@tmagic+core@1.7.6_typescript@5.9.3__@tmagic+vue-runtime-he_98f9c80ebf1387f841ccebd85af10b55/node_modules/@tmagic/vue-container/src/Container.vue"],"sourcesContent":["import { defineComponent, h, inject, type PropType, provide } from 'vue';\n\nimport type TMagicApp from '@tmagic/core';\nimport { Id, IS_DSL_NODE_KEY, MComponent, NODE_CONDS_RESULT_KEY } from '@tmagic/core';\nimport { useComponent, useComponentStatus, useNode, type UserRenderFunction } from '@tmagic/vue-runtime-help';\n\nexport default defineComponent({\n  name: 'tmagic-container-item',\n\n  props: {\n    config: {\n      type: Object as PropType<Omit<MComponent, 'id'>>,\n      required: true,\n    },\n    index: Number,\n    iteratorIndex: {\n      type: Array as PropType<number[]>,\n      default: () => [],\n    },\n    iteratorContainerId: {\n      type: Array as PropType<Id[]>,\n      default: () => [],\n    },\n    pageFragmentContainerId: {\n      type: [String, Number] as PropType<Id>,\n      default: '',\n    },\n  },\n\n  setup(props) {\n    const userRender = inject<UserRenderFunction>(\n      'userRender',\n      ({ h, type, props = {}, attrs = {}, style, className, on }) => {\n        const options: Record<string, any> = {\n          ...props,\n          ...attrs,\n          style,\n          class: className,\n        };\n        if (on) {\n          for (const [key, handler] of Object.entries(on)) {\n            options[`on${key[0].toLocaleUpperCase()}${key.substring(1)}`] = handler;\n          }\n        }\n        return h(type, options);\n      },\n    );\n\n    const app = inject<TMagicApp>('app');\n    const node = useNode(props);\n\n    const componentStatusStore = useComponentStatus(props);\n\n    provide('componentStatusStore', componentStatusStore);\n\n    const { style, className } = componentStatusStore;\n\n    return () => {\n      if (\n        props.config.visible === false ||\n        props.config.condResult === false ||\n        // 没有配置条件时，不会编译出condResult，所以这里是undefined\n        (typeof props.config.condResult === 'undefined' && props.config[NODE_CONDS_RESULT_KEY]) ||\n        (typeof props.config.display === 'function' && props.config.display({ app, node }) === false)\n      ) {\n        return null;\n      }\n\n      return userRender({\n        h,\n        config: props.config,\n        type: useComponent({ componentType: props.config.type, app }),\n        style: style.value,\n        className: className.value,\n        props: {\n          config: { ...props.config, [IS_DSL_NODE_KEY]: true },\n          containerIndex: props.index,\n          iteratorIndex: props.iteratorIndex,\n          iteratorContainerId: props.iteratorContainerId,\n          pageFragmentContainerId: props.pageFragmentContainerId,\n        },\n        attrs: {\n          'data-tmagic-id': props.config.id,\n          'data-tmagic-iterator-index': props.iteratorIndex.join(',') || undefined,\n          'data-tmagic-iterator-container-id': props.iteratorContainerId.join(',') || undefined,\n          'data-tmagic-container-index': props.index,\n          'data-tmagic-page-fragment-container-id': props.pageFragmentContainerId || undefined,\n        },\n      });\n    };\n  },\n});\n","<template>\n  <div @click=\"clickHandler\">\n    <slot>\n      <ItemComponent\n        v-for=\"(item, index) in config.items\"\n        :key=\"item.id\"\n        :config=\"item\"\n        :index=\"index\"\n        :iterator-index=\"iteratorIndex\"\n        :iterator-container-id=\"iteratorContainerId\"\n        :page-fragment-container-id=\"pageFragmentContainerId\"\n      ></ItemComponent>\n    </slot>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { inject } from 'vue';\n\nimport type TMagicApp from '@tmagic/core';\nimport { COMMON_EVENT_PREFIX, type Id, type MContainer } from '@tmagic/core';\nimport { type ComponentProps, registerNodeHooks, useNode } from '@tmagic/vue-runtime-help';\n\nimport ItemComponent from './Component';\n\ninterface ContainerSchema extends Omit<MContainer, 'id'> {\n  id?: Id;\n  type?: 'container';\n}\n\ndefineOptions({\n  name: 'tmagic-container',\n});\n\nconst props = defineProps<ComponentProps<ContainerSchema>>();\n\nconst app = inject<TMagicApp>('app');\nconst node = useNode(props, app);\nregisterNodeHooks(node);\n\nconst clickHandler = () => {\n  if (app && node) {\n    app.emit(`${COMMON_EVENT_PREFIX}click`, node);\n  }\n};\n</script>\n"],"names":["ItemComponent","defineComponent","name","props","config","type","Object","required","index","Number","iteratorIndex","Array","default","iteratorContainerId","pageFragmentContainerId","String","setup","userRender","inject","h","attrs","style","className","on","options","class","key","handler","entries","toLocaleUpperCase","substring","app","node","useNode","componentStatusStore","useComponentStatus","provide","visible","condResult","NODE_CONDS_RESULT_KEY","display","useComponent","componentType","value","IS_DSL_NODE_KEY","containerIndex","id","join","__props","registerNodeHooks","clickHandler","emit","COMMON_EVENT_PREFIX","_createElementBlock","onClick","_renderSlot","_ctx","_openBlock","_Fragment","items","item","_createBlock","_unref"],"mappings":"4VAMA,MAAAA,EAAeC,EAAgB,CAC7BC,KAAM,wBAENC,MAAO,CACLC,OAAQ,CACNC,KAAMC,OACNC,UAAU,GAEZC,MAAOC,OACPC,cAAe,CACbL,KAAMM,MACNC,QAASA,IAAM,IAEjBC,oBAAqB,CACnBR,KAAMM,MACNC,QAASA,IAAM,IAEjBE,wBAAyB,CACvBT,KAAM,CAACU,OAAQN,QACfG,QAAS,KAIbI,KAAAA,CAAMb,GACJ,MAAMc,EAAaC,EACjB,aACA,EAAGC,EAAAA,EAAGd,OAAMF,MAAAA,EAAQ,CAAA,EAAIiB,QAAQ,CAAA,EAAIC,MAAAA,EAAOC,UAAAA,EAAWC,SACpD,MAAMC,EAA+B,IAChCrB,KACAiB,EACHC,MAAAA,EACAI,MAAOH,GAET,GAAIC,EACF,IAAA,MAAYG,EAAKC,KAAYrB,OAAOsB,QAAQL,GAC1CC,EAAQ,KAAKE,EAAI,GAAGG,sBAAsBH,EAAII,UAAU,MAAQH,EAGpE,OAAOR,EAAEd,EAAMmB,KAIbO,EAAMb,EAAkB,OACxBc,EAAOC,EAAQ9B,GAEf+B,EAAuBC,EAAmBhC,GAEhDiC,EAAQ,uBAAwBF,GAEhC,MAAMb,MAAEA,EAAAC,UAAOA,GAAcY,EAE7B,MAAO,KAEsB,IAAzB/B,EAAMC,OAAOiC,UACe,IAA5BlC,EAAMC,OAAOkC,iBAEuB,IAA5BnC,EAAMC,OAAOkC,YAA8BnC,EAAMC,OAAOmC,IAC/B,mBAAzBpC,EAAMC,OAAOoC,UAAkE,IAAxCrC,EAAMC,OAAOoC,QAAQ,CAAET,MAAKC,SAEpE,KAGFf,EAAW,CAChBE,IACAf,OAAQD,EAAMC,OACdC,KAAMoC,EAAa,CAAEC,cAAevC,EAAMC,OAAOC,KAAM0B,QACvDV,MAAOA,EAAMsB,MACbrB,UAAWA,EAAUqB,MACrBxC,MAAO,CACLC,OAAQ,IAAKD,EAAMC,OAAQwC,CAACA,IAAkB,GAC9CC,eAAgB1C,EAAMK,MACtBE,cAAeP,EAAMO,cACrBG,oBAAqBV,EAAMU,oBAC3BC,wBAAyBX,EAAMW,yBAEjCM,MAAO,CACL,iBAAkBjB,EAAMC,OAAO0C,GAC/B,6BAA8B3C,EAAMO,cAAcqC,KAAK,WAAQ,EAC/D,oCAAqC5C,EAAMU,oBAAoBkC,KAAK,WAAQ,EAC5E,8BAA+B5C,EAAMK,MACrC,yCAA0CL,EAAMW,8BAA2B,IAGjF,+MCvDJ,MAAMX,EAAQ6C,EAERjB,EAAMb,EAAkB,OACxBc,EAAOC,EAAQ9B,EAAO4B,GAC5BkB,EAAkBjB,GAElB,MAAMkB,EAAeA,KACfnB,GAAOC,GACTD,EAAIoB,KAAK,GAAGC,SAA4BpB,sBAzC1CqB,EAYM,MAAA,CAZAC,QAAOJ,GAAY,CACvBK,EAUOC,sBAVP,IAUO,EATLC,GAAA,GAAAJ,EAQiBK,SAPSV,EAAA5C,OAAOuD,MAAK,CAA5BC,EAAMpD,SADhBqD,EAQiBC,EAAA9D,GAAA,CANd0B,IAAKkC,EAAKd,GACV1C,OAAQwD,EACRpD,QACA,iBAAgBwC,EAAAtC,cAChB,wBAAuBsC,EAAAnC,oBACvB,6BAA4BmC,EAAAlC","x_google_ignoreList":[0,1]}