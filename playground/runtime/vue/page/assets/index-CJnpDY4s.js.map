{"version":3,"file":"index-CJnpDY4s.js","sources":["../../../../../node_modules/.pnpm/@tmagic+vue-overlay@0.2.0_@tmagic+core@1.6.0_typescript@5.9.2__@tmagic+vue-runtime-help_d2323dafed08b37027dcaa710bbfcfd2/node_modules/@tmagic/vue-overlay/src/index.vue"],"sourcesContent":["<template>\n  <component v-if=\"visible\" :is=\"containerComponent\" :config=\"{ items: config.items, [IS_DSL_NODE_KEY]: false }\">\n    <slot></slot>\n  </component>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, onBeforeUnmount, type PropType, ref } from 'vue-demi';\n\nimport type TMagicApp from '@tmagic/core';\nimport { type Id, IS_DSL_NODE_KEY, type MContainer, type MNode, type MPage } from '@tmagic/core';\nimport { registerNodeHooks, useComponent, useNode } from '@tmagic/vue-runtime-help';\n\ninterface OverlaySchema extends Omit<MContainer, 'id'> {\n  id?: Id;\n  type?: 'overlay';\n}\n\nexport default defineComponent({\n  name: 'tmagic-overlay',\n\n  props: {\n    config: {\n      type: Object as PropType<OverlaySchema>,\n      required: true,\n    },\n    iteratorIndex: Array as PropType<number[]>,\n    iteratorContainerId: Array as PropType<Id[]>,\n    containerIndex: Number,\n    pageFragmentContainerId: [String, Number] as PropType<Id>,\n    model: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n\n  setup(props) {\n    const visible = ref(false);\n\n    const app = inject<TMagicApp>('app');\n    const containerComponent = useComponent({ componentType: 'container', app });\n\n    const openOverlay = () => {\n      visible.value = true;\n      app?.emit('overlay:open', node);\n    };\n\n    const closeOverlay = () => {\n      visible.value = false;\n      app?.emit('overlay:close', node);\n    };\n\n    const editorSelectHandler = (\n      info: {\n        node: MNode;\n        page: MPage;\n        parent: MContainer;\n      },\n      path: MNode[],\n    ) => {\n      if (path.find((node: MNode) => node.id === props.config.id)) {\n        openOverlay();\n      } else {\n        closeOverlay();\n      }\n    };\n\n    app?.page?.on('editor:select', editorSelectHandler);\n\n    onBeforeUnmount(() => {\n      app?.page?.off('editor:select', editorSelectHandler);\n    });\n\n    const node = useNode(props, app);\n    registerNodeHooks(node, {\n      openOverlay,\n      closeOverlay,\n    });\n\n    return {\n      containerComponent,\n      visible,\n      IS_DSL_NODE_KEY,\n    };\n  },\n});\n</script>\n"],"names":["_sfc_main","defineComponent","props","visible","ref","app","inject","containerComponent","useComponent","openOverlay","node","closeOverlay","editorSelectHandler","info","path","_a","onBeforeUnmount","useNode","registerNodeHooks","IS_DSL_NODE_KEY","_ctx","_openBlock","_createBlock","_resolveDynamicComponent","_renderSlot"],"mappings":"6LAkBA,MAAAA,EAAeC,EAAgB,CAC7B,KAAM,iBAEN,MAAO,CACL,OAAQ,CACN,KAAM,OACN,SAAU,EAAA,EAEZ,cAAe,MACf,oBAAqB,MACrB,eAAgB,OAChB,wBAAyB,CAAC,OAAQ,MAAM,EACxC,MAAO,CACL,KAAM,OACN,QAAS,KAAO,CAAA,EAAC,CACnB,EAGF,MAAMC,EAAO,OACX,MAAMC,EAAUC,EAAI,EAAK,EAEnBC,EAAMC,EAAkB,KAAK,EAC7BC,EAAqBC,EAAa,CAAE,cAAe,YAAa,IAAAH,EAAK,EAErEI,EAAc,IAAM,CACxBN,EAAQ,MAAQ,GAChBE,GAAA,MAAAA,EAAK,KAAK,eAAgBK,EAAI,EAG1BC,EAAe,IAAM,CACzBR,EAAQ,MAAQ,GAChBE,GAAA,MAAAA,EAAK,KAAK,gBAAiBK,EAAI,EAG3BE,EAAsB,CAC1BC,EAKAC,IACG,CACCA,EAAK,KAAMJ,GAAgBA,EAAK,KAAOR,EAAM,OAAO,EAAE,EACxDO,EAAA,EAEAE,EAAA,CACF,GAGFI,EAAAV,GAAA,YAAAA,EAAK,OAAL,MAAAU,EAAW,GAAG,gBAAiBH,GAE/BI,EAAgB,IAAM,QACpBD,EAAAV,GAAA,YAAAA,EAAK,OAAL,MAAAU,EAAW,IAAI,gBAAiBH,EAAmB,CACpD,EAED,MAAMF,EAAOO,EAAQf,EAAOG,CAAG,EAC/B,OAAAa,EAAkBR,EAAM,CACtB,YAAAD,EACA,aAAAE,CAAA,CACD,EAEM,CACL,mBAAAJ,EACA,QAAAJ,EACA,gBAAAgB,CAAA,CACF,CAEJ,CAAC,iCApFkBC,EAAA,SAAAC,EAAA,EAAjBC,EAEYC,EAFmBH,EAAA,kBAAkB,EAAA,CAAA,IAAA,EAAG,OAAM,CAAA,MAAWA,EAAA,OAAO,MAAK,CAAGA,EAAA,eAAe,EAAA,EAAA,CAAA,EAAA,WACjG,IAAa,CAAbI,EAAaJ,EAAA,OAAA,SAAA,CAAA,CAAA","x_google_ignoreList":[0]}