{"version":3,"file":"Container-DSOLbvRb.js","sources":["../../../../../node_modules/.pnpm/@tmagic+vue-container@2.0.0_@tmagic+core@1.7.6_typescript@5.9.3__@tmagic+vue-runtime-he_98f9c80ebf1387f841ccebd85af10b55/node_modules/@tmagic/vue-container/src/Component.ts","../../../../../node_modules/.pnpm/@tmagic+vue-container@2.0.0_@tmagic+core@1.7.6_typescript@5.9.3__@tmagic+vue-runtime-he_98f9c80ebf1387f841ccebd85af10b55/node_modules/@tmagic/vue-container/src/Container.vue"],"sourcesContent":["import { defineComponent, h, inject, type PropType, provide } from 'vue';\n\nimport type TMagicApp from '@tmagic/core';\nimport { Id, IS_DSL_NODE_KEY, MComponent, NODE_CONDS_RESULT_KEY } from '@tmagic/core';\nimport { useComponent, useComponentStatus, useNode, type UserRenderFunction } from '@tmagic/vue-runtime-help';\n\nexport default defineComponent({\n  name: 'tmagic-container-item',\n\n  props: {\n    config: {\n      type: Object as PropType<Omit<MComponent, 'id'>>,\n      required: true,\n    },\n    index: Number,\n    iteratorIndex: {\n      type: Array as PropType<number[]>,\n      default: () => [],\n    },\n    iteratorContainerId: {\n      type: Array as PropType<Id[]>,\n      default: () => [],\n    },\n    pageFragmentContainerId: {\n      type: [String, Number] as PropType<Id>,\n      default: '',\n    },\n  },\n\n  setup(props) {\n    const userRender = inject<UserRenderFunction>(\n      'userRender',\n      ({ h, type, props = {}, attrs = {}, style, className, on }) => {\n        const options: Record<string, any> = {\n          ...props,\n          ...attrs,\n          style,\n          class: className,\n        };\n        if (on) {\n          for (const [key, handler] of Object.entries(on)) {\n            options[`on${key[0].toLocaleUpperCase()}${key.substring(1)}`] = handler;\n          }\n        }\n        return h(type, options);\n      },\n    );\n\n    const app = inject<TMagicApp>('app');\n    const node = useNode(props);\n\n    const componentStatusStore = useComponentStatus(props);\n\n    provide('componentStatusStore', componentStatusStore);\n\n    const { style, className } = componentStatusStore;\n\n    return () => {\n      if (\n        props.config.visible === false ||\n        props.config.condResult === false ||\n        // 没有配置条件时，不会编译出condResult，所以这里是undefined\n        (typeof props.config.condResult === 'undefined' && props.config[NODE_CONDS_RESULT_KEY]) ||\n        (typeof props.config.display === 'function' && props.config.display({ app, node }) === false)\n      ) {\n        return null;\n      }\n\n      return userRender({\n        h,\n        config: props.config,\n        type: useComponent({ componentType: props.config.type, app }),\n        style: style.value,\n        className: className.value,\n        props: {\n          config: { ...props.config, [IS_DSL_NODE_KEY]: true },\n          containerIndex: props.index,\n          iteratorIndex: props.iteratorIndex,\n          iteratorContainerId: props.iteratorContainerId,\n          pageFragmentContainerId: props.pageFragmentContainerId,\n        },\n        attrs: {\n          'data-tmagic-id': props.config.id,\n          'data-tmagic-iterator-index': props.iteratorIndex.join(',') || undefined,\n          'data-tmagic-iterator-container-id': props.iteratorContainerId.join(',') || undefined,\n          'data-tmagic-container-index': props.index,\n          'data-tmagic-page-fragment-container-id': props.pageFragmentContainerId || undefined,\n        },\n      });\n    };\n  },\n});\n","<template>\n  <div @click=\"clickHandler\">\n    <slot>\n      <ItemComponent\n        v-for=\"(item, index) in config.items\"\n        :key=\"item.id\"\n        :config=\"item\"\n        :index=\"index\"\n        :iterator-index=\"iteratorIndex\"\n        :iterator-container-id=\"iteratorContainerId\"\n        :page-fragment-container-id=\"pageFragmentContainerId\"\n      ></ItemComponent>\n    </slot>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { inject } from 'vue';\n\nimport type TMagicApp from '@tmagic/core';\nimport { COMMON_EVENT_PREFIX, type Id, type MContainer } from '@tmagic/core';\nimport { type ComponentProps, registerNodeHooks, useNode } from '@tmagic/vue-runtime-help';\n\nimport ItemComponent from './Component';\n\ninterface ContainerSchema extends Omit<MContainer, 'id'> {\n  id?: Id;\n  type?: 'container';\n}\n\ndefineOptions({\n  name: 'tmagic-container',\n});\n\nconst props = defineProps<ComponentProps<ContainerSchema>>();\n\nconst app = inject<TMagicApp>('app');\nconst node = useNode(props, app);\nregisterNodeHooks(node);\n\nconst clickHandler = () => {\n  if (app && node) {\n    app.emit(`${COMMON_EVENT_PREFIX}click`, node);\n  }\n};\n</script>\n"],"names":["ItemComponent","defineComponent","props","userRender","inject","h","type","attrs","style","className","on","options","key","handler","app","node","useNode","componentStatusStore","useComponentStatus","provide","NODE_CONDS_RESULT_KEY","useComponent","IS_DSL_NODE_KEY","__props","registerNodeHooks","clickHandler","COMMON_EVENT_PREFIX","_createElementBlock","_renderSlot","_ctx","_openBlock","_Fragment","item","index","_createBlock","_unref"],"mappings":"kPAMA,MAAAA,EAAeC,EAAgB,CAC7B,KAAM,wBAEN,MAAO,CACL,OAAQ,CACN,KAAM,OACN,SAAU,EAAA,EAEZ,MAAO,OACP,cAAe,CACb,KAAM,MACN,QAAS,IAAM,CAAA,CAAC,EAElB,oBAAqB,CACnB,KAAM,MACN,QAAS,IAAM,CAAA,CAAC,EAElB,wBAAyB,CACvB,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,EAAA,CACX,EAGF,MAAMC,EAAO,CACX,MAAMC,EAAaC,EACjB,aACA,CAAC,CAAE,EAAAC,EAAG,KAAAC,EAAM,MAAAJ,EAAQ,CAAA,EAAI,MAAAK,EAAQ,CAAA,EAAI,MAAAC,EAAO,UAAAC,EAAW,GAAAC,KAAS,CAC7D,MAAMC,EAA+B,CACnC,GAAGT,EACH,GAAGK,EACH,MAAAC,EACA,MAAOC,CAAA,EAET,GAAIC,EACF,SAAW,CAACE,EAAKC,CAAO,IAAK,OAAO,QAAQH,CAAE,EAC5CC,EAAQ,KAAK,OAAAC,EAAI,CAAC,EAAE,kBAAA,GAAsB,OAAAA,EAAI,UAAU,CAAC,EAAG,EAAIC,EAGpE,OAAOR,EAAEC,EAAMK,CAAO,CAAA,CACxB,EAGIG,EAAMV,EAAkB,KAAK,EAC7BW,EAAOC,EAAQd,CAAK,EAEpBe,EAAuBC,EAAmBhB,CAAK,EAErDiB,EAAQ,uBAAwBF,CAAoB,EAEpD,KAAM,CAAE,MAAAT,EAAO,UAAAC,CAAA,EAAcQ,EAE7B,MAAO,IAEHf,EAAM,OAAO,UAAY,IACzBA,EAAM,OAAO,aAAe,IAE3B,OAAOA,EAAM,OAAO,WAAe,KAAeA,EAAM,OAAOkB,CAAqB,GACpF,OAAOlB,EAAM,OAAO,SAAY,YAAcA,EAAM,OAAO,QAAQ,CAAE,IAAAY,EAAK,KAAAC,EAAM,IAAM,GAEhF,KAGFZ,EAAW,CAChB,EAAAE,EACA,OAAQH,EAAM,OACd,KAAMmB,EAAa,CAAE,cAAenB,EAAM,OAAO,KAAM,IAAAY,EAAK,EAC5D,MAAON,EAAM,MACb,UAAWC,EAAU,MACrB,MAAO,CACL,OAAQ,CAAE,GAAGP,EAAM,OAAQ,CAACoB,CAAe,EAAG,EAAA,EAC9C,eAAgBpB,EAAM,MACtB,cAAeA,EAAM,cACrB,oBAAqBA,EAAM,oBAC3B,wBAAyBA,EAAM,uBAAA,EAEjC,MAAO,CACL,iBAAkBA,EAAM,OAAO,GAC/B,6BAA8BA,EAAM,cAAc,KAAK,GAAG,GAAK,OAC/D,oCAAqCA,EAAM,oBAAoB,KAAK,GAAG,GAAK,OAC5E,8BAA+BA,EAAM,MACrC,yCAA0CA,EAAM,yBAA2B,MAAA,CAC7E,CACD,CACH,CAEJ,CAAC,mMCzDD,MAAMA,EAAQqB,EAERT,EAAMV,EAAkB,KAAK,EAC7BW,EAAOC,EAAQd,EAAOY,CAAG,EAC/BU,EAAkBT,CAAI,EAEtB,MAAMU,EAAe,IAAM,CACrBX,GAAOC,GACTD,EAAI,KAAK,GAAG,OAAAY,EAAmB,SAASX,CAAI,CAC9C,oBA1CAY,EAYM,MAAA,CAZA,QAAOF,GAAY,CACvBG,EAUOC,sBAVP,IAUO,EATLC,EAAA,EAAA,EAAAH,EAQiBI,SAPSR,EAAA,OAAO,MAAK,CAA5BS,EAAMC,SADhBC,EAQiBC,EAAAnC,CAAA,EAAA,CANd,IAAKgC,EAAK,GACV,OAAQA,EACR,MAAAC,EACA,iBAAgBV,EAAA,cAChB,wBAAuBA,EAAA,oBACvB,6BAA4BA,EAAA,uBAAA","x_google_ignoreList":[0,1]}