import{d as h,i as g,u as E,w as M,e as T,f as w,j as F,n as x,g as _,o as b,I as u,v as j}from"./index-CB05xkW7.js";import{a as y}from"./use-app-BjZx0Alq.js";import{u as k}from"./use-component-status-B306AcGu.js";const A=(()=>{const c=new Map;return(s,i,e=globalThis.document)=>{let t=c.get(e);if(t||(t=new Map,c.set(e,t)),t.get(s))return t.get(s);const m=new Promise((l,o)=>{const d=e.createElement("script");d.type="text/javascript",i&&(d.crossOrigin=i),d.src=s,e.body.appendChild(d),d.onload=()=>{l()},d.onerror=()=>{o(new Error("加载失败"))},setTimeout(()=>{o(new Error("timeout"))},60*1e3)}).catch(l=>{throw t.delete(s),l});return t.set(s,m),t.get(s)}})(),f=(()=>{const c=new Map;return(s,i=globalThis.document)=>{let e=c.get(i);if(e||(e=new Map,c.set(i,e)),e.get(s))return e.get(s);const t=new Promise((m,l)=>{const o=i.createElement("link");o.rel="stylesheet",o.href=s,i.head.appendChild(o),o.onload=()=>{m()},o.onerror=()=>{l(new Error("加载失败"))},setTimeout(()=>{l(new Error("timeout"))},60*1e3)}).catch(m=>{throw e.delete(s),m});return e.set(s,t),e.get(s)}})(),D=h({name:"tmagic-page",__name:"index",props:{config:{},model:{default:()=>({})}},setup(c){const s=n=>{if(n.cssFile&&f(n.cssFile),Array.isArray(n.cssFiles)&&n.cssFiles.map(a=>f(a.url)),n.css){const a=window.document.createElement("style");a.innerHTML=n.css,window.document.head.appendChild(a)}},i=n=>{Array.isArray(n.jsFiles)&&n.jsFiles.map(a=>A(a.url))},e=c,t=g("app");(t==null?void 0:t.jsEngine)==="browser"&&(s(e.config),i(e.config));const m=E({componentType:"container",app:t}),{style:l,className:o}=k(e),d=()=>{window.location.reload()};return M(()=>e.config,async(n,a)=>{const r=y({config:{...n,[u]:!0}},t);if(n.id!==(a==null?void 0:a.id)&&(r==null||r.setInstance({config:e.config,refresh:d}),r==null||r.emit("created")),await j(),n.id!==(a==null?void 0:a.id)){r==null||r.emit("mounted");const p=y({config:{...a,[u]:!0}},t);p==null||p.emit("destroy")}},{immediate:!0}),(n,a)=>(b(),T(_(w(m)),{class:x(w(o)),style:F(w(l)),"data-tmagic-id":c.config.id,config:{...c.config,[w(u)]:!1}},null,8,["class","style","data-tmagic-id","config"]))}});export{D as default};
//# sourceMappingURL=index-BF6WX_Gk.js.map
